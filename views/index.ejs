<%- include("partials/header", { path, title: "Home" }) %>

<style>
   img,
   video {
      object-fit: cover;
      object-position: center;
      width: 69%;
      height: auto;
   }

   video {
      display: block;
      margin: auto;
   }

   .ping {
      color: #f8cfb4;
      background-color: rgba(248, 207, 180, 0.2);
      border-radius: 5px;
      padding: 1.5px 3.5px 1.5px 3.5px;
      cursor: pointer;
      transition: 0.25s;
   }

   .ping:hover {
      background-color: rgba(248, 207, 180, 0.4);
      transition: 0.25s;
   }

   .spoiler {
      filter: blur(10px) grayscale(.5);
      transition-property: -webkit-filter;
      transition-duration: .4s;
      -webkit-filter: blur(10px) grayscale(.5);
      -webkit-transition-property: -webkit-filter;
      -webkit-transition-duration: .4s;
   }

   .spoiler:hover,
   .spoiler:focus {
      filter: blur(0px) grayscale(0);
      -webkit-filter: blur(0px) grayscale(0);
   }
</style>

<%- include("partials/nav") %>

<div class="app-window app-window--pastel fixed-top">
   <div class="action-bar action-bar--pastel">
      <p class="app-window__name app-window__name--pastel">
         <%= attachments[0].username %>
      </p>
      <button title="Minimize" class="action action--pastel action--minimize">_</button>
      <button title="Close" class="action action--pastel action--close">X</button>
   </div>
   <div class="app-window__body--pastel">
      <section class="about-me about-me--pastel">
         <h5 class="title title--pastel">About me</h5>
         <section class="about-me__body about-me__body--pastel">
            <p>
               ╭ ─⨯─➪ .✧
               <br>
               |・nonbinary (they/them)
               <br>
               |・coms are open!
               <br>
               |・anemo main (genshin)
               <br>
               |・art staff on YYM, PMM, TRTSM
               <br>
               |・<a href="https://ashnscar21.carrd.co/">https://ashnscar21.carrd.co/</a>
               <br>
               ╰ ─⨯─✿-❥︎--➪ *.✧
            </p>
         </section>
      </section>
      <section class="social-media social-media--pastel">
         <h5 class="title title--pastel">Social Media</h5>
         <section class="social-media__body social-media__body--pastel">
            <a class="social-media__link social-media__link--pastel" href="#">
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="social-media__icon social-media__icon--spotify" viewBox="0 0 16 16">
                  <path
                     d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.669 11.538a.498.498 0 0 1-.686.165c-1.879-1.147-4.243-1.407-7.028-.77a.499.499 0 0 1-.222-.973c3.048-.696 5.662-.397 7.77.892a.5.5 0 0 1 .166.686zm.979-2.178a.624.624 0 0 1-.858.205c-2.15-1.321-5.428-1.704-7.972-.932a.625.625 0 0 1-.362-1.194c2.905-.881 6.517-.454 8.986 1.063a.624.624 0 0 1 .206.858zm.084-2.268C10.154 5.56 5.9 5.419 3.438 6.166a.748.748 0 1 1-.434-1.432c2.825-.857 7.523-.692 10.492 1.07a.747.747 0 1 1-.764 1.288z">
                  </path>
               </svg>
               <h5 class="social-media__name">Spotify</h5>
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  viewBox="0 0 16 16">
                  <path fill-rule="evenodd"
                     d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z">
                  </path>
                  <path fill-rule="evenodd"
                     d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z">
                  </path>
               </svg>
            </a>
            <a class="social-media__link social-media__link--pastel" href="#">
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="social-media__icon social-media__icon--twitch" viewBox="0 0 16 16">
                  <path
                     d="M3.857 0 1 2.857v10.286h3.429V16l2.857-2.857H9.57L14.714 8V0H3.857zm9.714 7.429-2.285 2.285H9l-2 2v-2H4.429V1.143h9.142v6.286z">
                  </path>
                  <path d="M11.857 3.143h-1.143V6.57h1.143V3.143zm-3.143 0H7.571V6.57h1.143V3.143z"></path>
               </svg>
               <h5 class="social-media__name">Twitch</h5>
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  viewBox="0 0 16 16">
                  <path fill-rule="evenodd"
                     d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z">
                  </path>
                  <path fill-rule="evenodd"
                     d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z">
                  </path>
               </svg>
            </a>
            <a class="social-media__link social-media__link--pastel" href="#">
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="social-media__icon social-media__icon--twitter" viewBox="0 0 16 16">
                  <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/>
               </svg>
               <h5 class="social-media__name">Twitter</h5>
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  viewBox="0 0 16 16">
                  <path fill-rule="evenodd"
                     d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z">
                  </path>
                  <path fill-rule="evenodd"
                     d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z">
                  </path>
               </svg>
            </a>
            <a class="social-media__link social-media__link--pastel" href="#">
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  class="social-media__icon social-media__icon--youtube" viewBox="0 0 16 16">
                  <path d="M8.051 1.999h.089c.822.003 4.987.033 6.11.335a2.01 2.01 0 0 1 1.415 1.42c.101.38.172.883.22 1.402l.01.104.022.26.008.104c.065.914.073 1.77.074 1.957v.075c-.001.194-.01 1.108-.082 2.06l-.008.105-.009.104c-.05.572-.124 1.14-.235 1.558a2.007 2.007 0 0 1-1.415 1.42c-1.16.312-5.569.334-6.18.335h-.142c-.309 0-1.587-.006-2.927-.052l-.17-.006-.087-.004-.171-.007-.171-.007c-1.11-.049-2.167-.128-2.654-.26a2.007 2.007 0 0 1-1.415-1.419c-.111-.417-.185-.986-.235-1.558L.09 9.82l-.008-.104A31.4 31.4 0 0 1 0 7.68v-.123c.002-.215.01-.958.064-1.778l.007-.103.003-.052.008-.104.022-.26.01-.104c.048-.519.119-1.023.22-1.402a2.007 2.007 0 0 1 1.415-1.42c.487-.13 1.544-.21 2.654-.26l.17-.007.172-.006.086-.003.171-.007A99.788 99.788 0 0 1 7.858 2h.193zM6.4 5.209v4.818l4.157-2.408L6.4 5.209z"/>
               </svg>
               <h5 class="social-media__name">Youtube</h5>
               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                  viewBox="0 0 16 16">
                  <path fill-rule="evenodd"
                     d="M8.636 3.5a.5.5 0 0 0-.5-.5H1.5A1.5 1.5 0 0 0 0 4.5v10A1.5 1.5 0 0 0 1.5 16h10a1.5 1.5 0 0 0 1.5-1.5V7.864a.5.5 0 0 0-1 0V14.5a.5.5 0 0 1-.5.5h-10a.5.5 0 0 1-.5-.5v-10a.5.5 0 0 1 .5-.5h6.636a.5.5 0 0 0 .5-.5z">
                  </path>
                  <path fill-rule="evenodd"
                     d="M16 .5a.5.5 0 0 0-.5-.5h-5a.5.5 0 0 0 0 1h3.793L6.146 9.146a.5.5 0 1 0 .708.708L15 1.707V5.5a.5.5 0 0 0 1 0v-5z">
                  </path>
               </svg>
            </a>
         </section>
      </section>
   </div>
</div>
<div class="d-flex flex-column text-center justify-content-center">
<% attachments.forEach(function(object) {%>
   <div class="card app-window app-window--XP position-relative mb-3 text-center justify-content-center">
      <% const ping=/<@&933943397440450631>/g;
         const img = /<:\w+:(\d+)>/g;
         const spoiler = /\|\|(.*)\|\|/;
         const imgTag = `<img src="https://cdn.discordapp.com/emojis/$1.png" alt="$&" style="width: 32px; height: 32px;" />`;
         const spanTag = `<span class="ping">@Ash's creations</span>`;
         const spoilerTag = `<span class="spoiler">$1</span>`;
         let updatedDesc = object.desc.replace(img, imgTag);
         updatedDesc = updatedDesc.replace(/\n/g, "<br>");
         updatedDesc = updatedDesc.replace(ping, spanTag);
         updatedDesc = updatedDesc.replace(spoiler, spoilerTag);
         const renderedDesc = ejs.render(updatedDesc);
      %>
         <div class="bg--outer"></div>
         <div class="bg--inner"></div>
         <div class="action-bar action-bar--XP">
            <p class="app-window__name app-window__name--XP">
               <%= object.date %>
            </p>
            <button title="Minimize" class="action action--XP action--minimize--XP">_</button>
            <button title="Close" class="action action--XP action--close--XP">X</button>
         </div>
         <div class="card-body">
            <h6 class="card-subtitle mb-2 text-muted">Uploaded by <%= object.username %>
            </h6>
            <p class="card-title"><%- renderedDesc %></p>
         </div>
         <div id="carousel-<%= object.id %>" class="carousel carousel-dark slide"
            data-bs-ride="carousel">
            <ol class="carousel-indicators" style="z-index: 999;">
               <% object.attach.forEach(function(attachment, i) { %>
                  <button type="button" data-bs-target="#carousel-<%= object.id %>"
                     data-bs-slide-to="<%= i %>" class="<%= i === 0 ? " active" : "" %>"></li>
                     <% }); %>
            </ol>
            <div class="carousel-inner">
               <% object.attach.forEach(function(attachment, i) {
                  const search=attachment.search(/SPOILER_/);
                  const fileExtension=attachment.split(".").pop(); %>
                  <% if (fileExtension==="mp4" ) { %>
                  <div class="carousel-item <%= i === 0 ? " active" : "" %>">
                     <video src="<%= attachment %>" class="<%= search !== -1 ? " spoiler" : "" %>"
                        controls></video>
                  </div>
                  <% } else { %>
                     <div class="carousel-item <%= i === 0 ? " active" : "" %>">
                        <a href="<%= attachment %>" data-lightbox="<%= object.date %>"
                           class="imglink <%= search !== -1 ? " spoiler" : "" %>">
                           <img src="<%= attachment %>" alt="<%= object.date %>" />
                        </a>
                        <div class="imginfo">
                           <% object.reactions.forEach(function(emoji, i) { %>
                              <% if (emoji[0].id !==null) { %>
                                 <img src="https://cdn.discordapp.com/emojis/<%= emoji[0].id %>.png" alt="<%= emoji[0].name %>" style="width: 23px; height: 23px;" />
                                 <% } else { %>
                                    <span class="imgtitle">
                                       <%= emoji[0].name %>
                                    </span>
                                 <% } %>
                                 <span class="imgdesc">
                                    <%= emoji[0].count %>
                                 </span>
                              <% }); %>
                        </div>
                     </div>
                  <% } %>
               <% }); %>
            </div>
            <button class="carousel-control-prev" type="button"
               data-bs-target="#carousel-<%= object.id %>" data-bs-slide="prev">
               <span class="carousel-control-prev-icon" aria-hidden="true"></span>
               <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button"
               data-bs-target="#carousel-<%= object.id %>" data-bs-slide="next">
               <span class="carousel-control-next-icon" aria-hidden="true"></span>
               <span class="visually-hidden">Next</span>
            </button>
         </div>
      </div>
   <% }); %>
</div>

<%- include("partials/footer") %>